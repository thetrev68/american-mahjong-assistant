# Knip Analysis Report - October 10, 2025

Generated by running `npx knip` to identify unused dependencies, files, and exports.

## Summary

- **Unused Files:** 9
- **Unused Dependencies:** 2
- **Unlisted Dependencies:** 8
- **Unused Exports:** 142
- **Unused Exported Types:** 9
- **Duplicate Exports:** 7

---

## 1. Unused Files (9)

### High Priority - Safe to Remove

#### `packages/frontend/src/contexts/SocketProvider.tsx`
- **Status:** Likely replaced by `useSocketContext` hook
- **Action:** Verify no references, then DELETE
- **Risk:** LOW (context system has been refactored)

#### `packages/frontend/src/test/jest-dom.d.ts`
- **Status:** Jest type definitions (project uses Vitest)
- **Action:** DELETE (not needed for Vitest)
- **Risk:** LOW

### Medium Priority - Verify Before Removing

#### Shared Types Files (all in `packages/shared-types/src/`)
- `game-state-types.ts`
- `game-types.ts`
- `multiplayer-types.ts`
- `nmjl-types.ts`
- `room-types.ts`
- `socket-event-types.ts`
- `tile-types.ts`

**Issue:** These are imported via `packages/shared-types/src/index.ts` barrel exports
**Root Cause:** Knip doesn't recognize barrel export patterns well
**Action:** KEEP - These files ARE used, just re-exported through index.ts
**Risk:** HIGH (breaking change if removed)

---

## 2. Unused Dependencies (2)

### `socket.io` in root `package.json:33`
```json
"socket.io": "^4.8.1"
```
- **Location:** Root workspace
- **Status:** Backend uses it, but root package.json might not need it
- **Action:** Verify if backend imports from root or has its own dependency
- **Recommendation:** If backend has `socket.io` in its own package.json, remove from root

### `socket.io` in `packages/frontend/package.json:27`
```json
"socket.io": "^4.8.1"
```
- **Location:** Frontend workspace
- **Status:** Frontend uses `socket.io-client`, not `socket.io` (server)
- **Action:** REMOVE (frontend should only have `socket.io-client`)
- **Risk:** LOW (wrong package)

---

## 3. Unlisted Dependencies (8)

**Issue:** Internal `@shared-types/*` imports are not listed in package.json dependencies

### Files with unlisted dependencies:

1. **`packages/frontend/src/stores/multiplayer-store.ts:4`**
   - Import: `@shared-types/room-types`
   - Should use: `import type { ... } from 'shared-types'`

2. **`packages/frontend/src/stores/useRoomStore.ts:4`**
   - Import: `@shared-types/room-types`
   - Should use: `import type { ... } from 'shared-types'`

3. **`packages/frontend/src/stores/charleston-store.ts:2`**
   - Import: `@shared-types/nmjl-types`
   - Should use: `import type { ... } from 'shared-types'`

4. **`packages/frontend/src/lib/services/analysis-engine.ts:7`**
   - Import: `@shared-types/game-types`
   - Should use: `import type { ... } from 'shared-types'`

5. **`packages/frontend/src/stores/useGameStore.ts:3`**
   - Import: `@shared-types/game-types`
   - Should use: `import type { ... } from 'shared-types'`

6. **`packages/frontend/src/stores/useGameStore.ts:4`**
   - Import: `@shared-types/nmjl-types`
   - Should use: `import type { ... } from 'shared-types'`

7. **`packages/frontend/src/stores/useIntelligenceStore.ts:2`**
   - Import: `@shared-types/game-types`
   - Should use: `import type { ... } from 'shared-types'`

8. **`packages/frontend/src/stores/useUIStore.ts:5`**
   - Import: `@shared-types/game-state-types`
   - Should use: `import type { ... } from 'shared-types'`

**Action:** Replace all `@shared-types/[specific-type]` imports with `shared-types` (using the barrel export)
**Risk:** LOW (just import path changes)

---

## 4. Unused Exports (142 total)

### High Priority - Clearly Unused

#### Connection/Network Utilities (3)
- `useConnectionStatus` - packages/frontend/src/hooks/useConnectionResilience.ts:308
- `useNetworkAware` - packages/frontend/src/hooks/useConnectionResilience.ts:321
- `ConnectionStatusBar` - packages/frontend/src/ui-components/ConnectionStatusIndicator.tsx:177

#### Animation Utilities (2)
- `measureAnimationPerformance` - packages/frontend/src/utils/animation-config.ts:300
- `motionSafeStyles` - packages/frontend/src/utils/reduced-motion.ts:249
- `getMotionSafeClasses` - packages/frontend/src/utils/reduced-motion.ts:265

#### Monitoring Utilities (6)
- `captureException` - packages/frontend/src/utils/monitoring/error-tracker.ts:210
- `captureGameError` - packages/frontend/src/utils/monitoring/error-tracker.ts:219
- `captureNetworkError` - packages/frontend/src/utils/monitoring/error-tracker.ts:235
- `withErrorBoundary` - packages/frontend/src/utils/monitoring/ProductionErrorBoundary.tsx:213
- `useErrorHandler` - packages/frontend/src/utils/monitoring/ProductionErrorBoundary.tsx:229
- `getPerformanceReport` - packages/frontend/src/utils/monitoring/performance-monitor.ts:286
- `measurePatternAnalysis` - packages/frontend/src/utils/monitoring/performance-monitor.ts:289
- `measureTileRender` - packages/frontend/src/utils/monitoring/performance-monitor.ts:299

#### Feature Flags (1)
- `getFeatureConfig` - packages/frontend/src/utils/feature-flags.ts:115

#### Game Actions (1)
- `useGameActions` - packages/frontend/src/features/gameplay/services/game-actions.ts:702

#### UI Components (Potentially Unused) (9)
- `GameActionsPanel` - packages/frontend/src/ui-components/GameActionsPanel.tsx:20
- `ConfidenceMeter` - packages/frontend/src/ui-components/analysis/ConfidenceMeter.tsx:13
- `RecommendationBadge` - packages/frontend/src/ui-components/analysis/RecommendationBadge.tsx:14
- `ThreatIndicator` - packages/frontend/src/ui-components/analysis/ThreatIndicator.tsx:18
- `PatternProgressRing` - packages/frontend/src/ui-components/analysis/PatternProgressRing.tsx:17
- `MobileNavigation` - packages/frontend/src/ui-components/mobile/MobileNavigation.tsx:29
- `FloatingActionButton` - packages/frontend/src/ui-components/mobile/MobileNavigation.tsx:274
- `TouchOptimizedTile` - packages/frontend/src/ui-components/mobile/TouchOptimizedTile.tsx:38
- `AccessibilitySettings` - packages/frontend/src/ui-components/accessibility/AccessibilitySettings.tsx:18

#### Accessibility Utilities (3)
- `createAccessibilityContext` - packages/frontend/src/ui-components/accessibility/accessibility-utils.ts:32
- `useAccessibilityContext` - packages/frontend/src/ui-components/accessibility/accessibility-utils.ts:36
- `RovingTabIndex` - packages/frontend/src/ui-components/accessibility/FocusManager.tsx:142

#### Performance/Lazy Loading (2)
- `createLazyComponent` - packages/frontend/src/ui-components/performance/lazy-utils.ts:16
- `usePreloadComponent` - (truncated in output)

### Strategy Advisor Module - Massive Unused Code (~100+ exports)

**MAJOR FINDING:** The entire `features/strategy-advisor/` module appears to have massive amounts of unused code:

- Gesture handling utilities
- Animation systems
- Performance monitoring
- Pull-to-refresh components
- Skeleton loaders
- Error recovery hooks
- Memory optimization
- Bundle analysis
- Micro-animations
- And many more...

**Recommendation:** This module needs a comprehensive audit. Likely candidates:
1. **Over-engineered:** Features built but never integrated
2. **Premature optimization:** Performance code added speculatively
3. **Abandoned features:** Started but not completed

**Action:**
- Review `features/strategy-advisor/` directory structure
- Identify what's actually used in GlanceModePanel.tsx
- Remove entire unused utility files
- Consolidate remaining code

---

## 5. Unused Exported Types (9)

### Gameplay Types
- `DiscardRecommendation` - packages/frontend/src/features/gameplay/services/game-actions.ts:24
- `CallOpportunity` - packages/frontend/src/features/gameplay/services/game-actions.ts:35

### Charleston Types
- `CharlestonEventData` - packages/frontend/src/features/charleston/services/charleston-resilient.ts:21

### Intelligence Types
- `IntelligenceSnapshot` - packages/frontend/src/types/intelligence.ts:129

### Tutorial Types
- `TutorialStore` - packages/frontend/src/features/tutorial/types.ts:130

### Strategy Advisor Types (4)
- `StrategyMessageCardProps` - packages/frontend/src/features/strategy-advisor/types/strategy-advisor.types.ts:218
- `LongPressPatternDetails` - packages/frontend/src/features/strategy-advisor/types/strategy-advisor.types.ts:706
- `DisclosureAccessibility` - packages/frontend/src/features/strategy-advisor/types/strategy-advisor.types.ts:824
- `EnhancedStrategyMessage` - packages/frontend/src/features/strategy-advisor/types/strategy-advisor.types.ts:947

**Action:** Review each type - if truly unused, remove from exports (keep internal if used within file)

---

## 6. Duplicate Exports (7)

**Issue:** Both named export and default export for the same component

### Files with duplicate exports:
1. `ErrorBoundary` - packages/frontend/src/features/strategy-advisor/components/ErrorBoundary.tsx
2. `LoadingStates` - packages/frontend/src/features/strategy-advisor/components/LoadingStates.tsx
3. `SkeletonLoader` - packages/frontend/src/features/strategy-advisor/components/SkeletonLoader.tsx
4. `microAnimations` - packages/frontend/src/features/strategy-advisor/utils/micro-animations.ts
5. `useErrorRecovery` - packages/frontend/src/features/strategy-advisor/hooks/useErrorRecovery.ts
6. `usePerformanceMonitoring` - packages/frontend/src/features/strategy-advisor/hooks/usePerformanceMonitoring.ts
7. `useMemoryOptimization` - packages/frontend/src/features/strategy-advisor/hooks/useMemoryOptimization.ts

**Action:** Choose one export style (prefer named exports for consistency)
**Risk:** LOW (just standardization)

---

## Recommended Action Plan

### Phase 1: Quick Wins (Low Risk)
1. ✅ Remove `packages/frontend/src/test/jest-dom.d.ts`
2. ✅ Remove `packages/frontend/src/contexts/SocketProvider.tsx` (after verification)
3. ✅ Remove `socket.io` from `packages/frontend/package.json` (use `socket.io-client` only)
4. ✅ Fix duplicate exports (choose named exports)
5. ✅ Fix unlisted dependencies (use `shared-types` barrel exports)

### Phase 2: Medium Effort (Medium Risk)
1. 🔍 Audit and remove clearly unused exports from:
   - Connection/network utilities
   - Animation utilities
   - Monitoring utilities
2. 🔍 Remove unused UI components (after verification)
3. 🔍 Remove unused types

### Phase 3: Major Cleanup (High Impact)
1. 🚨 **Strategy Advisor Module Audit**
   - Review entire `features/strategy-advisor/` directory
   - Identify core used code
   - Remove/consolidate massive amounts of unused utilities
   - Potentially reduce codebase by 1000+ lines

### Phase 4: Verification
1. Run full test suite
2. Run lint check
3. Run knip again to verify cleanup
4. Manual testing of core features

---

## Commands for Future Sessions

```bash
# Run knip analysis
npx knip

# Run knip with specific focus
npx knip --include exports
npx knip --include dependencies
npx knip --include files

# Fix duplicate exports automatically
npx knip --fix --fix-type exports

# Run with production mode (exclude dev dependencies)
npx knip --production
```

---

## Notes

- This analysis was done on commit: `e973317` (2025-10-10)
- Total potential LOC reduction: 1500+ lines (conservative estimate)
- Strategy Advisor module appears to be the biggest source of dead code
- Shared-types "unused files" are FALSE POSITIVES (barrel export pattern)
- All cleanup should be done incrementally with testing between phases

---

## Status: AWAITING REVIEW

Next session should start with Phase 1 (Quick Wins).
